<!DOCTYPE html>
<html lang="en">

<head>
    <!-- 必须的 meta 标签 -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap 的 CSS 文件 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>

    <title>主页</title>
</head>

<body>
    <div class="container">
        <div id="homePage">
            <div class="row">
                <div class="col-6">
                    <h2>中华银行</h2>
                </div>
                <div class="col-6">
                    <ul class="nav justify-content-end">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" onclick="homeRegisterBtnClick()">注册</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" onclick="homeLoginBtnClick()">登录</a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- 装饰用 -->
            <div class="row mb-5">
                <img src="./img/General 1920x1080 car money toys paper numbers vehicle dollar bills re.jpg"
                    class="img-fluid" style="height: 500px;" alt="...">
            </div>

            <div class="row">
                <div class="card-group">
                    <div class="card">
                        <img src="./img/Person holds a smartphone with mobile banking icons projection..jpg"
                            class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">This is a wider card with supporting text below as a natural lead-in to
                                additional content. This content is a little bit longer.</p>
                            <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                        </div>
                    </div>
                    <div class="card">
                        <img src="./img/Bank sign on a modern glass building. 3D render..jpg" class="card-img-top"
                            alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">This card has supporting text below as a natural lead-in to additional
                                content.
                            </p>
                            <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                        </div>
                    </div>
                    <div class="card">
                        <img src="./img/Bank building.jpg" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">This is a wider card with supporting text below as a natural lead-in to
                                additional content. This card has even longer content than the first to show that equal
                                height
                                action.</p>
                            <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                        </div>
                    </div>
                </div>
                <div class="card-group">
                    <div class="card">
                        <img src="./img/Person holds a smartphone with mobile banking icons projection..jpg"
                            class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">This is a wider card with supporting text below as a natural lead-in to
                                additional content. This content is a little bit longer.</p>
                            <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                        </div>
                    </div>
                    <div class="card">
                        <img src="./img/Bank sign on a modern glass building. 3D render..jpg" class="card-img-top"
                            alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">This card has supporting text below as a natural lead-in to additional
                                content.
                            </p>
                            <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                        </div>
                    </div>
                    <div class="card">
                        <img src="./img/Bank building.jpg" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text">This is a wider card with supporting text below as a natural lead-in to
                                additional content. This card has even longer content than the first to show that equal
                                height
                                action.</p>
                            <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="loginPage" class="invisible">
            <div class="row ms-5">
                <div class="col-3">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="./bank.html">首页</a></li>
                            <li class="breadcrumb-item active" aria-current="page">登录</li>
                        </ol>
                    </nav>
                </div>
            </div>
            <div class="row d-flex justify-content-center mt-5  ">
                <div class="col-4 ">
                    <form class="shadow-lg p-3 mb-5 bg-body rounded">
                        <div class="mb-3">
                            <label for="exampleInputEmail1" class="form-label">用户名
                                <input type="text" class="form-control" id="exampleInputName1" value=""
                                    aria-describedby="emailHelp"></label>
                            <!-- <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div> -->
                        </div>
                        <div class="mb-3">
                            <label for="exampleInputPassword1" class="form-label">密码
                                <input type="password" class="form-control" value="" id="exampleInputPassword1"></label>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="exampleCheck1">
                            <label class="form-check-label" for="exampleCheck1">记住我</label>
                        </div>
                        <button type="button" class="btn btn-primary" onclick="login()" id="loginBtn">登录</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- 注册界面 -->
    <div id="registerPage" class="invisible">
        <div class="row ms-5">
            <div class="col-3">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="./bank.html">首页</a></li>
                        <li class="breadcrumb-item active" aria-current="page"></a>注册</li>
                    </ol>
                </nav>
            </div>
        </div>
        <div class="row d-flex justify-content-center mt-5">
            <div class="col-4">
                <form class="shadow-lg p-3 mb-5 bg-body rounded">
                    <div class="mb-3">
                        <label for="exampleInputEmail1" class="form-label">用户名
                            <input type="text" class="form-control" id="exampleInputName2" value=""
                                aria-describedby="emailHelp"></label>
                        <!-- <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div> -->
                    </div>
                    <div class="mb-3">
                        <label for="exampleInputPassword1" class="form-label">密码
                            <input type="password" class="form-control" value="" id="exampleInputPassword2"></label>
                    </div>
                    <!-- <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="exampleCheck1">
                            <label class="form-check-label" for="exampleCheck1">记住我</label>
                        </div> -->
                    <button type="button" class="btn btn-primary" onclick="registeBtnClick()"
                        id="registerLoginBtn">注册并登录</button>
                </form>
            </div>
        </div>
    </div>

    <!-- 二级菜单 -->
    <div class="text-center " id="secondChildPage">
        <!-- 用户选择区 -->
        <div class="row justify-content-center">
            <div class="col-3">
                <div class="d-grid gap-2">
                    <button class="btn btn-primary" type="button" onclick="queryRemainMoney()">1. 查询</button>
                    <button class="btn btn-primary" type="button" onclick="storeMoney()">2. 存钱</button>
                    <button class="btn btn-primary" type="button" onclick="drawMoney()">3. 取钱</button>
                    <button class="btn btn-primary" type="button" onclick="transMoney()">4. 转账</button>
                    <button class="btn btn-primary" type="button" onclick="changePwd()">5. 修改密码</button>
                    <button class="btn btn-primary" type="button">6. 退出</button>
                </div>
            </div>
            <div class="col-5" id="userChooseDetail">
                <div class="mb-3 row">
                    <label for="inputPassword" class="col-sm-3 col-form-label">收账账户:
                        <div class="col-sm-9">
                            <input type="text" class="form-control " id="drawMoneyAccount" value="">
                        </div>
                    </label>
                </div>

                <div class="input-group mb-3">
                    <label for="inputPassword" class="col-sm-3 col-form-label">存取金额:</label>
                    <span class="input-group-text">￥</span>
                    <input type="text" class="form-control" id="userInputMoney"
                        aria-label="Amount (to the nearest dollar)" value="">
                    <span class="input-group-text">.00</span>
                </div>


            </div>
        </div>
        <!-- 数据展示区 -->
        <div class="row d-flex justify-content-center mt-5">
            <div class="col-7">
                <table class="table table-borderless">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">用户名</th>
                            <th scope="col">剩余金额</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">1</th>
                            <td id="userNameShowTd">Mark</td>
                            <td id="userMoneyShowTd">1000</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    </div>

    <!-- 主页菜单函数 -->
    <script>
        // 用户信息
        let userInfo = [];
        let userInfoSecond = [];
        function homeRegisterBtnClick() {
            let registerPageHtml = window.document.getElementById("registerPage").innerHTML;
            window.document.getElementById("homePage").innerHTML = registerPageHtml;
        }
        function homeLoginBtnClick() {
            let registerPageHtml = window.document.getElementById("loginPage").innerHTML;
            window.document.getElementById("homePage").innerHTML = registerPageHtml;
        }

        function registeBtnClick(params) {
            let name = window.document.getElementById("exampleInputName2").value;
            let pwd = window.document.getElementById("exampleInputPassword2").value;
            let registeSuccessInfo = checkRegistSuccess(name, pwd);
            if (!registeSuccessInfo) {
                alert("用户名已存在");
                return;
            }
            let nowDate = new Date();
            userInfoSecond = userInfoStore(name, pwd, nowDate.getTime());
            let userIndex = userInfo.index;

            let secondChildPageHtml = window.document.getElementById("secondChildPage").innerHTML;
            window.document.getElementById("homePage").innerHTML = secondChildPageHtml;
        }
    </script>

    <!-- 一级菜单函数 -->
    <script>
        // ********************一级菜单函数********************
        // 检查注册成功否
        function checkRegistSuccess(name, pwd) {
            userInfo.forEach(element => {
                if (element.userName === name) {
                    return false;
                }
            });
            return true;
        }

        // 用户注册信息入表
        function userInfoStore(name, pwd, date) {
            userInfo.push({
                userName: name,
                userPwd: pwd,
                index: userInfo.length,
                userDetailInfo: {
                    createTime: date,
                    money: 1000
                }
            });
            return userInfo[userInfo.length - 1];
        }

        function queryUserIndexByName(name) {
            let userNameIndex = -1;
            let flag = userInfo.some((value, index) => {
                if (value.userName === name) {
                    userNameIndex = index;
                }
            });

            return userNameIndex;
        }

        function checkPwd(name, pwd) {
            let flag = false;
            userInfo.forEach(element => {
                if (element.userName === name && element.userPwd === pwd) {
                    flag = true;
                }
            });
            return flag;
        }
    </script>

    <!-- 二级菜单函数 -->
    <script>
        // ********************二级菜单函数********************
        function queryRemainMoney() {
            upDataUserShow(0);
        }

        function storeMoney(money) {
            money = window.document.getElementById("userInputMoney").value;
            upDataUserShow(money);
        }

        function drawMoney(userInfoSecond, money) {
            money = window.document.getElementById("userInputMoney").value;
            upDataUserShow(-money);
        }

        function changePwd(index, pwd) {
            let userChooseDetailPageHtml = ` <div class="mb-3 row">
                    <label for="inputPassword" class="col-sm-3 col-form-label">旧密码:</label>
                    <div class="col-sm-9">
                        <input type="password" class="form-control" value="" id="oldPwd">
                    </div>
                </div>
                <div class="mb-3 row">
                    <label for="inputPassword" class="col-sm-3 col-form-label">新密码:</label>
                    <div class="col-sm-9">
                        <input type="password" class="form-control " value="" id="newPwd">
                    </div>
                </div>
                <div class="mb-3 row">
                    <label for="inputPassword" class="col-sm-3 col-form-label">再次确认密码:</label>
                    <div class="col-sm-9">
                        <input type="password" class="form-control " value="" id="newPwdAgain">
                    </div>
                </div>
                <div class="mb-3 row">
                    <button class="btn btn-primary" type="button" onclick="changePwdSure()">确认</button>
                </div>`;
            window.document.getElementById("userChooseDetail").innerHTML = userChooseDetailPageHtml;
        }

        function transMoney() {
            let transUserAccount = window.document.getElementById("drawMoneyAccount").value;
            let transferAccountIndex = queryUserIndexByName(transUserAccount);
            if (transferAccountIndex === -1) {
                alert(`${transferAccount}用户不存在,请核对后重新输入`);
                return;
            }
            // 当前账户金额减
            drawMoney();
            // 转账账户金额加
            userInfo[userInfoSecond.index].userDetailInfo.money += window.document.getElementById("userInputMoney").value - 0;
            alert("转账成功");
        }

        function changePwdSure() {
            let oldPwd = window.document.getElementById("oldPwd").value;
            let newPwd = window.document.getElementById("newPwd").value;
            let newPwdAgain = window.document.getElementById("newPwdAgain").value;
            if (oldPwd !== userInfoSecond.userPwd) {
                alert("旧密码不正确");
                return;
            }
            if (newPwd !== newPwdAgain) {
                alert("2次密码输入不一致,请核对后输入");
                return;
            }
            alert("密码修改成功");
        }

        function upDataUserShow(money) {
            let userName = userInfoSecond.userName;
            let userMoney = userInfoSecond.userDetailInfo.money + (money - 0);
            // 更新用户剩余金额
            userInfoSecond.userDetailInfo.money = userMoney;
            window.document.getElementById("userNameShowTd").innerHTML = userName;
            window.document.getElementById("userMoneyShowTd").innerHTML = userMoney;
        }
    </script>
</body>

</html>